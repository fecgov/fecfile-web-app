<div [formGroup]="form">
  <div class="grid">
    <div class="col-8">
      <div class="field">
        <label for="amount">ORIGINAL AMOUNT</label>
        <p-inputNumber
          [formControlName]="templateMap['amount']"
          currency="USD"
          inputId="amount"
          locale="en-US"
          mode="currency"
        ></p-inputNumber>
        <app-error-messages
          [fieldName]="templateMap['amount']"
          [formSubmitted]="formSubmitted"
          [form]="form"
        ></app-error-messages>
      </div>
    </div>
  </div>
  <p-divider></p-divider>
  <h3>Terms</h3>
  <app-loan-terms-dates-input
    [formSubmitted]="formSubmitted"
    [form]="form"
    [templateMap]="templateMap"
    [transaction]="transaction"
  ></app-loan-terms-dates-input>
  <app-yes-no-radio-input
    [formSubmitted]="formSubmitted"
    [form]="form"
    ariaLabelNo="This loan has not been restructured"
    ariaLabelYes="This loan has been restructured"
    controlName="loan_restructured"
    label="Has loan been restructured?"
  ></app-yes-no-radio-input>
  <ng-container *ngIf="showLoanRestructured">
    <div class="grid">
      <div class="col-4">
        <div class="field">
          <label for="loan_originally_incurred_date">DATE OF ORIGINAL LOAN</label>
          <p-calendar
            formControlName="loan_originally_incurred_date"
            inputId="loan_originally_incurred_date"
            name="date_signed"
          ></p-calendar>
          <app-error-messages
            [formSubmitted]="formSubmitted"
            [form]="form"
            fieldName="loan_originally_incurred_date"
          ></app-error-messages>
        </div>
      </div>
    </div>
  </ng-container>
  <app-yes-no-radio-input
    [formSubmitted]="formSubmitted"
    [form]="form"
    ariaLabelNo="There is not a line of credit"
    ariaLabelYes="There is a line of credit"
    controlName="line_of_credit"
    label="Is there a line of credit? (OPTIONAL)"
  ></app-yes-no-radio-input>
  <ng-container *ngIf="showLineOfCredit">
    <div class="grid">
      <div class="col-4">
        <div class="field">
          <label for="credit_amount_this_draw">CREDIT AMOUNT THIS DRAW (OPTIONAL)</label>
          <p-inputNumber
            currency="USD"
            formControlName="credit_amount_this_draw"
            inputId="credit_amount_this_draw"
            locale="en-US"
            mode="currency"
          ></p-inputNumber>
          <app-error-messages
            [formSubmitted]="formSubmitted"
            [form]="form"
            fieldName="credit_amount_this_draw"
          ></app-error-messages>
        </div>
      </div>
      <div class="col-4">
        <div class="field">
          <label for="balance">TOTAL BALANCE</label>
          <p-inputNumber
            [formControlName]="templateMap['balance']"
            currency="USD"
            inputId="balance"
            locale="en-US"
            mode="currency"
          ></p-inputNumber>
          <app-error-messages
            [fieldName]="templateMap['balance']"
            [formSubmitted]="formSubmitted"
            [form]="form"
          ></app-error-messages>
        </div>
      </div>
    </div>
  </ng-container>
  <p-divider></p-divider>
  <h3>Others liable</h3>
  <app-yes-no-radio-input
    [formSubmitted]="formSubmitted"
    [form]="form"
    ariaLabelNo="Other parties are not secondarily liable"
    ariaLabelYes="Other parties are secondarily liable"
    controlName="others_liable"
    label="Are other parties secondarily liable for the debt incurred?"
  ></app-yes-no-radio-input>
  <ng-container *ngIf="showOthersLiable">
    <div class="grid">
      <div class="col-12">
        <div class="field">
          <span class="bold"
          >Endorsers and guarantors must be reported on Schedule C - Loan received from bank in STEP ONE</span
          >
        </div>
      </div>
    </div>
  </ng-container>
  <p-divider></p-divider>
  <h3>Collateral</h3>
  <app-yes-no-radio-input
    [controlName]="templateMap['secured']"
    [formSubmitted]="formSubmitted"
    [form]="form"
    ariaLabelNo="Collateral has not been pledged"
    ariaLabelYes="Collateral has been pledged"
    label="Are any of the following pledged as collateral for the loan: real estate, personal property, goods, negotiable instruments, certificates of deposit, chattel papers, stocks, accounts receivable, cash on deposit, or other similar traditional collateral?"
  ></app-yes-no-radio-input>
  <ng-container *ngIf="showSecured">
    <div class="grid">
      <div class="col-12">
        <label for="desc_collateral">COLLATERAL DESCRIPTION</label>
        <div>
          <textarea
            [autoResize]="true"
            [cols]="30"
            [rows]="5"
            formControlName="desc_collateral"
            id="desc_collateral"
            pInputTextarea
          ></textarea>
          <app-error-messages
            [formSubmitted]="formSubmitted"
            [form]="form"
            fieldName="desc_collateral"
          ></app-error-messages>
        </div>
      </div>
    </div>
    <div class="grid">
      <div class="col-4">
        <div class="field">
          <label for="collateral_value_amount">COLLATERAL AMOUNT</label>
          <p-inputNumber
            currency="USD"
            formControlName="collateral_value_amount"
            inputId="collateral_value_amount"
            locale="en-US"
            mode="currency"
          ></p-inputNumber>
          <app-error-messages
            [formSubmitted]="formSubmitted"
            [form]="form"
            fieldName="collateral_value_amount"
          ></app-error-messages>
        </div>
      </div>
    </div>
    <app-yes-no-radio-input
      [formSubmitted]="formSubmitted"
      [form]="form"
      ariaLabelNo="Lender does not have a perfected security interest"
      ariaLabelYes="Lender has a perfected security interest"
      controlName="perfected_interest"
      label="Does the lender have a perfected security interest in it? (OPTIONAL)"
    ></app-yes-no-radio-input>
  </ng-container>
  <p-divider></p-divider>
  <h3>Future income</h3>
  <app-yes-no-radio-input
    [formSubmitted]="formSubmitted"
    [form]="form"
    ariaLabelNo="Future income has not been pledged"
    ariaLabelYes="Future income has been pledged"
    controlName="future_income"
    label="Are any future contributions or future receipts of interest income, pledged as collateral for the loan?"
  ></app-yes-no-radio-input>
  <ng-container *ngIf="showFutureIncome">
    <div class="grid">
      <div class="col-12">
        <label for="desc_specification_of_the_above">FUTURE INCOME DESCRIPTION</label>
        <div>
          <textarea
            [autoResize]="true"
            [cols]="30"
            [rows]="5"
            formControlName="desc_specification_of_the_above"
            id="desc_specification_of_the_above"
            pInputTextarea
          ></textarea>
          <app-error-messages
            [formSubmitted]="formSubmitted"
            [form]="form"
            fieldName="desc_specification_of_the_above"
          ></app-error-messages>
        </div>
      </div>
    </div>
    <div class="grid">
      <div class="col-5">
        <div class="field">
          <label for="estimated_value">ESTIMATED VALUE</label>
          <p-inputNumber
            currency="USD"
            formControlName="estimated_value"
            inputId="estimated_value"
            locale="en-US"
            mode="currency"
          ></p-inputNumber>
          <app-error-messages
            [formSubmitted]="formSubmitted"
            [form]="form"
            fieldName="estimated_value"
          ></app-error-messages>
        </div>
      </div>
      <div class="col-5">
        <div class="field">
          <label for="depository_account_established_date">DEPOSITORY ACCOUNT ESTABLISHED</label>
          <p-calendar
            formControlName="depository_account_established_date"
            inputId="depository_account_established_date"
            name="date_signed"
          ></p-calendar>
          <app-error-messages
            [formSubmitted]="formSubmitted"
            [form]="form"
            fieldName="depository_account_established_date"
          ></app-error-messages>
        </div>
      </div>
    </div>
    <div class="grid">
      <div class="col-12">
        <div class="field">
          <label for="location_of_account">LOCATION OF ACCOUNT</label>
          <span
            class="pi pi-info-circle"
            pTooltip="{{ locationOfAccountHelpText }}"
            style="font-size: 1.5rem; margin-left: 0.5rem"
          ></span>
          <app-transaction-contact-lookup
            (contactSelect)="updateFormWithLocationOfAccountContact($event)"
            [contactTypeOptions]="contactTypeOptions"
            [formSubmitted]="formSubmitted"
            [form]="form"
            [transaction]="transaction"
            contactProperty="contact_2"
          ></app-transaction-contact-lookup>
        </div>
      </div>
    </div>
    <ng-container *ngIf="showLocationOfAccount">
      <div class="grid">
        <div class="col-12">
          <div class="field">
            <label for="secondary_name">ORGANIZATION NAME</label>
            <input [formControlName]="templateMap['secondary_name']" id="secondary_name" pInputText type="text" />
            <app-error-messages
              [fieldName]="templateMap['secondary_name']"
              [formSubmitted]="formSubmitted"
              [form]="form"
            ></app-error-messages>
          </div>
        </div>
      </div>
      <app-address-input
        [formSubmitted]="formSubmitted"
        [form]="form"
        [templateMap]="templateMap"
        templateMapKeyPrefix="secondary"
      ></app-address-input>
    </ng-container>
  </ng-container>
  <p-divider></p-divider>
  <h3>Basis of loan</h3>
  <div class="grid">
    <div class="col-12">
      <p>
        If neither of the types of collateral described above was pledged for this loan, or if the amount pledged does
        not equal or exceed the loan amount, state the basis upon which this loan was made and the basis on which it
        assures repayment.
      </p>
      <label for="basis_of_loan_description">DESCRIPTION (OPTIONAL)</label>
      <div>
        <textarea
          [autoResize]="true"
          [cols]="30"
          [rows]="5"
          formControlName="basis_of_loan_description"
          id="basis_of_loan_description"
          pInputTextarea
        ></textarea>
        <app-error-messages
          [formSubmitted]="formSubmitted"
          [form]="form"
          fieldName="basis_of_loan_description"
        ></app-error-messages>
      </div>
    </div>
  </div>
</div>
