<div [formGroup]="form">
  @if (templateMap.purpose_description) {
    <div class="grid">
      <div class="col-12">
        <div class="field">
          <span class="span-label" id="purpose_description_label">
            {{ transactionType()?.purposeDescripLabel }}
            <span class="paren-label">{{ transactionType()?.generatePurposeDescriptionLabel() }}</span>
          </span>
          @if (transactionType()?.purposeDescriptionLabelNotice) {
            <em>
              {{ transactionType()?.purposeDescriptionLabelNotice }}
            </em>
          }

          <textarea
            id="purpose_description"
            aria-labelledby="purpose_description_label"
            [rows]="4"
            [cols]="30"
            appAutoResize
            [formControlName]="templateMap['purpose_description']"
            [class.readonly]="isDescriptionSystemGenerated()"
            [readonly]="isDescriptionSystemGenerated()"
          ></textarea>
          <app-error-messages
            [form]="form"
            [fieldName]="templateMap['purpose_description']"
            [formSubmitted]="formSubmitted"
          />
        </div>
      </div>
    </div>
  }
  @if (transactionType()?.hasDesignatedSubordinate()) {
    <app-designated-subordinate-input
      [form]="form"
      [formSubmitted]="formSubmitted"
      [templateMap]="templateMap"
      [transaction]="transaction()"
      (designatingCommitteeSelect)="onDesignatingCommitteeSelect($event)"
      (designatingCommitteeClear)="onDesignatingCommitteeClear()"
      (subordinateCommitteeSelect)="onSubordinateCommitteeSelect($event)"
      (subordinateCommitteeClear)="onSubordinateCommitteeClear()"
    />
  }
  @if (transactionType()?.hasMemoText()) {
    <div class="grid">
      <div class="col-12">
        <div class="field">
          <span class="span-label" id="text4000_label"
            >NOTE OR MEMO TEXT
            <span class="paren-label">{{
              transactionType()?.memoTextRequired ? '(REQUIRED)' : '(OPTIONAL)'
            }}</span></span
          >
          <textarea
            id="text4000"
            aria-labelledby="text4000_label"
            [rows]="5"
            [cols]="30"
            appAutoResize
            [formControlName]="templateMap['text4000']"
          ></textarea>
          <app-error-messages [form]="form" [fieldName]="templateMap['text4000']" [formSubmitted]="formSubmitted" />
        </div>
      </div>
    </div>
  }
  @if (transactionType()?.hasCategoryCode()) {
    <div class="grid">
      <div class="col-6">
        <div class="field flex flex-column">
          <span class="span-label" id="category_code_label"
            >CATEGORY CODE <span class="paren-label">(OPTIONAL)</span></span
          >
          <p-select
            data-cy="category_code"
            aria-labelledby="category_code_label"
            [formControlName]="templateMap['category_code']"
            [options]="categoryCodeOptions"
            [autoDisplayFirst]="false"
            appendTo="body"
            class="w-full"
            [showClear]="true"
          />
          <app-error-messages
            [form]="form"
            [fieldName]="templateMap['category_code']"
            [formSubmitted]="formSubmitted"
          />
        </div>
      </div>
    </div>
  }
</div>
