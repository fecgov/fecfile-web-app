<p-toast></p-toast>

<div class="p-fluid">
  <h1>{{ transaction?.transactionType?.title }}</h1>
  <h3>Contact</h3>
  <form id="form" [formGroup]="form" [ngClass]="{ 'ng-submitted': formSubmitted }">
    <div class="grid">
      <div class="col-12">
        <label for="entity_type">CONTACT TYPE</label>
        <app-transaction-contact-lookup
          [contactTypeFormControl]="$any(form).controls['entity_type']"
          [contactTypeOptions]="contactTypeOptions"
          [contactTypeReadOnly]="true"
          (contactSelect)="onContactLookupSelect($event)"
        >
        </app-transaction-contact-lookup>
      </div>
    </div>
    <ng-container *ngIf="transaction?.contact">
      <app-name-input [form]="form" [formSubmitted]="formSubmitted" [templateMap]="templateMap"></app-name-input>
      <p-divider></p-divider>
      <h3>Address</h3>
      <app-address-input [form]="form" [formSubmitted]="formSubmitted" [templateMap]="templateMap"></app-address-input>
      <p-divider></p-divider>
      <ng-container *ngIf="this.transaction?.transactionType?.scheduleId !== 'B'">
        <h3>Employer</h3>
        <app-employer-input
          [form]="form"
          [formSubmitted]="formSubmitted"
          [templateMap]="templateMap"
        ></app-employer-input>
        <p-divider></p-divider>
      </ng-container>
      <h3>Receipt Information</h3>
      <app-amount-input
        [form]="form"
        [formSubmitted]="formSubmitted"
        [templateMap]="templateMap"
        [memoCodeReadOnly]="isMemoCodeReadOnly(transaction?.transactionType)"
        [negativeAmountValueOnly]="!!transaction?.transactionType?.negativeAmountValueOnly"
      ></app-amount-input>
      <p-divider></p-divider>
      <h3>Additional Information</h3>
      <app-additional-info-input
        [form]="form"
        [formSubmitted]="formSubmitted"
        [templateMap]="templateMap"
        [descriptionIsSystemGenerated]="isDescriptionSystemGenerated(transaction?.transactionType)"
        [purposeDescriptionLabel]="this.purposeDescriptionLabel"
      ></app-additional-info-input>
      <div class="grid">
        <ng-template ngFor let-navigationControl [ngForOf]="getInlineControls()">
          <div class="col-3">
            <app-navigation-control
              [navigationControl]="navigationControl"
              [transaction]="transaction"
              (navigate)="handleNavigate($event)"
            ></app-navigation-control>
          </div>
        </ng-template>
      </div>
      <div class="grid" *ngIf="subTransactionOptions.length > 0">
        <div class="col-2">
          <p-dropdown
            inputId="subTransaction"
            [options]="subTransactionOptions"
            formControlName="subTransaction"
            [autoDisplayFirst]="false"
            (onChange)="createSubTransaction($event)"
            placeholder="Save & add a Memo"
            dropdownIcon="pi pi-plus"
            styleClass="sub-transaction-dropdown"
            panelStyleClass="sub-transaction-dropdown-panel"
          ></p-dropdown>
        </div>
      </div>
      <p-divider></p-divider>
    </ng-container>
    <app-navigation-control-bar
      [navigationControls]="getNavigationControls()"
      [transaction]="transaction"
      (navigate)="handleNavigate($event)"
    ></app-navigation-control-bar>
  </form>
</div>

<p-confirmDialog key="dialog" [style]="{ width: '450px' }"></p-confirmDialog>
