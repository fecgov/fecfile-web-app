<p-toast></p-toast>
<h1>{{ transactionType?.title }}</h1>
<p>
  This type of receipt requires a memo transaction. Follow this two-step process to create both an earmark receipt and
  an earmark memo:
</p>
<p-accordion>
  <p-accordionTab>
    <ng-template pTemplate="header">
      <strong>STEP ONE:</strong>
      <p style="font-weight: normal">Add receipt and contributor information</p></ng-template
    >
    <div class="p-fluid">
      <h2>Receipt</h2>
      <h3>Contact</h3>
      <form id="form" [formGroup]="form" [ngClass]="{ 'ng-submitted': formSubmitted }">
        <div class="grid">
          <div class="col-12">
            <label for="entity_type">CONTACT TYPE</label>
            <app-contact-lookup
              [contactTypeFormControl]="$any(form).controls['entity_type']"
              [contactTypeOptions]="contactTypeOptions"
              [contactTypeReadOnly]="true"
              contactTypeStyleClass="readonly"
              (contactSelect)="onContactLookupSelect($event)"
            >
            </app-contact-lookup>
          </div>
        </div>
        <app-name-input [form]="form" [formSubmitted]="formSubmitted"></app-name-input>
        <p-divider></p-divider>
        <h3>Address</h3>
        <app-address-input [form]="form" [formSubmitted]="formSubmitted"></app-address-input>
        <p-divider></p-divider>
        <h3>Employer</h3>
        <app-employer-input [form]="form" [formSubmitted]="formSubmitted"></app-employer-input>
        <p-divider></p-divider>
        <h3>Receipt Information</h3>
        <app-amount-input [form]="form" [formSubmitted]="formSubmitted"></app-amount-input>
        <p-divider></p-divider>
        <h3>Additional Information</h3>
        <app-additional-info-input [form]="form" [formSubmitted]="formSubmitted"></app-additional-info-input>
      </form>
    </div>
  </p-accordionTab>

  <p-accordionTab>
    <ng-template pTemplate="header">
      <strong>STEP TWO:</strong>
      <p style="font-weight: normal">
        Add earmarked memo and conduit information (REQUIRED FOR EARMARKED RECEIPTS)
      </p></ng-template
    >
    <div class="p-fluid">
      <h2>Earmark memo</h2>
      <h3>Conduit</h3>
      <form id="childForm" [formGroup]="childForm" [ngClass]="{ 'ng-submitted': formSubmitted }">
        <div class="grid">
          <div class="col-12">
            <div class="field">
              <label for="entity_type">ENTITY TYPE</label>
              <app-contact-lookup
                [contactTypeFormControl]="$any(childForm).controls['entity_type']"
                [contactTypeOptions]="childContactTypeOptions"
                (contactSelect)="childOnContactLookupSelect($event)"
              >
              </app-contact-lookup>
            </div>
          </div>
        </div>
        <ng-container *ngIf="childForm.get('entity_type')?.value === ContactTypes.COMMITTEE">
          <app-committee-input [form]="childForm" [formSubmitted]="formSubmitted"></app-committee-input>
        </ng-container>
        <ng-container *ngIf="childForm.get('entity_type')?.value === ContactTypes.INDIVIDUAL">
          <app-name-input [form]="childForm" [formSubmitted]="formSubmitted"></app-name-input>
        </ng-container>
        <p-divider></p-divider>
        <h3>Address</h3>
        <app-address-input
          [form]="childForm"
          [formSubmitted]="formSubmitted"
          [stateOptions]="stateOptions"
        ></app-address-input>
        <p-divider></p-divider>
        <ng-container *ngIf="childForm.get('entity_type')?.value === ContactTypes.INDIVIDUAL">
          <h3>Employer</h3>
          <app-employer-input [form]="childForm" [formSubmitted]="formSubmitted"></app-employer-input>
          <p-divider></p-divider>
        </ng-container>
        <h3>Receipt Information</h3>
        <app-amount-input
          [form]="childForm"
          [formSubmitted]="formSubmitted"
          [memoCodeReadOnly]="true"
          [contributionAmountReadOnly]="true"
        ></app-amount-input>
        <p-divider></p-divider>
        <h3>Additional Information</h3>
        <app-additional-info-input [form]="childForm" [formSubmitted]="formSubmitted"></app-additional-info-input>
      </form>
    </div>
  </p-accordionTab>
</p-accordion>

<div class="grid">
  <div class="col-2">
    <button pButton pRipple label="Cancel" class="p-button-secondary" (click)="navigateTo('list')"></button>
  </div>
  <div ng-class="isExisting(transaction) ? 'col-7' : 'col-4'"></div>
  <div class="col-3">
    <button
      pButton
      pRipple
      label="Save & view all transactions"
      class="p-button-primary"
      (click)="save('list')"
    ></button>
  </div>
</div>

<p-confirmDialog key="dialog" [style]="{ width: '450px' }"></p-confirmDialog>
<p-confirmDialog key="childDialog" [style]="{ width: '450px' }"></p-confirmDialog>
