<app-table title="Loans and Debts" [items]="items" [totalItems]="totalItems" [loading]="loading"
  sortField="line_label_order_key,created" [rowsPerPage]="rowsPerPage" [selectAll]="selectAll"
  [selectedItems]="selectedItems" currentPageReportTemplate="Showing {first} to {last} of {totalRecords} transactions"
  (loadTableItems)="loadTableItems($event)" (selectionChange)="onSelectionChange($event)"
  (selectAllChange)="onSelectAllChange($event)">
  <ng-template #header>
    <tr role="row">
      <th *ngFor="let h of sortableHeaders" [pSortableColumn]="h.field" [id]="h.field + '-column'" role="columnheader">
        {{ h.label }}
        <p-sortIcon [field]="h.field"></p-sortIcon>
      </th>
      <th id="transaction_id" role="columnheader">Transaction ID</th>
      <th id="back_reference_tran_id_number" role="columnheader">Associated With</th>
      <th id="buttons" role="columnheader">Actions</th>
    </tr>
  </ng-template>
  <ng-template #body let-item>
    <tr role="row">
      <td class="no-wrap">
        {{ item.line_label }}
      </td>
      <td>
        <a [routerLink]="[item?.id]">{{ item.transaction_type_identifier | label: scheduleTransactionTypeLabels }}</a>
        <div *ngIf="item?.itemized === false"><strong>Unitemized</strong></div>
      </td>
      <td>
        {{ item.name }}
      </td>
      <td>
        {{ item[item.transactionType.templateMap.date] | fecDate }}
      </td>
      <td>
        {{ item['amount'] | currency }}
      </td>
      <td>
        {{ item['balance'] | currency }}
      </td>
      <td>
        {{ formatId(item.transaction_id) }}
      </td>
      <td>
        {{ formatId(item.back_reference_tran_id_number) }}
      </td>
      <td>
        <app-table-actions-button [tableActions]="rowActions" [actionItem]="item"
          (tableActionClick)="onRowActionClick($event.action, $event.actionItem)" buttonIcon="pi pi-ellipsis-v"
          buttonStyleClass="p-button-text" buttonAriaLabel="action"
          dataTest="loans-and-debts-button"></app-table-actions-button>
      </td>
    </tr>
  </ng-template>
</app-table>